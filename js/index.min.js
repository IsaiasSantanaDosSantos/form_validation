let s = document.querySelector('.erroMsg');
document
  .querySelector('.registre-form')
  .addEventListener('submit', function (e) {
    e.preventDefault();
    let r = document.querySelector('.registre-form');
    function o() {
      let o = true;
      for (let e of r.querySelectorAll('.required')) {
        const t =
          e.previousElementSibling && e.previousElementSibling.innerText;
        if (e.classList.contains('name')) {
          if (!n(e)) {
            a(e, t);
            e.classList.add('fieldError');
            e.focus();
            return (o = false);
          }
        }
        if (e.classList.contains('rg')) {
          if (!i(e)) {
            a(e, t);
            return (o = false);
          }
        }
        if (e.classList.contains('email')) {
          if (!d(e)) {
            a(e, t);
            return (o = false);
          }
        }
        if (e.classList.contains('phoneNumber')) {
          if (!u(e)) {
            a(e, t);
            return (o = false);
          }
        }
        if (e.classList.contains('postalCode')) {
          if (!l()) {
            a(e, t);
            return (o = false);
          }
        }
        if (e.classList.contains('homeNumber')) {
          if (!c(e)) {
            a(e, t);
            return;
          }
        }
        e.classList.remove('fieldError');
        e.blur();
      }
      return true;
    }
    o();
    if (!o()) {
      return;
    }
    alert('Dados validados com sucesso!');
    const t = document.querySelectorAll('input');
    t.forEach((e) => {
      e.value = '';
      e.classList.remove('fieldError');
    });
  });
function n(o) {
  const e = o.value;
  const t = /^[a-zA-ZÀ-ÿ]+(([',. -][a-zA-ZÀ-ÿ ])?[a-zA-ZÀ-ÿ]*)*$/;
  if (!t.test(e)) {
    let e = 'Nome';
    a(o, e);
    o.classList.add('fieldError');
    o.focus();
    return false;
  } else if (e.length < 5) {
    s.innerHTML = `O campo "Nome" precisa ter mais de 5 caracteres.`;
    o.classList.add('fieldError');
    o.focus();
    return false;
  }
  o.classList.remove('fieldError');
  o.blur();
  s.innerHTML = '';
  return true;
}
function i(e) {
  const o = e.value;
  let t = o.replace(/\D/g, '');
  if (t.length < 6) {
    s.innerHTML = '';
    s.innerHTML = `O campos "RG" deve ter mais de 6 dígitos`;
    valid = false;
    e.classList.add('fieldError');
    e.focus();
    return;
  }
  const r = t.replace(/^(\d{2})(\d{3})(\d{3})(\d{1})$/, '$1.$2.$3-$4');
  document.getElementById('rg').value = r;
  e.classList.remove('fieldError');
  e.blur();
  s.innerHTML = '';
  return true;
}
function d(o) {
  const e = o.value;
  let t = true;
  const r = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
  if (!r.test(e)) {
    let e = 'Email';
    a(o, e);
    o.classList.add('fieldError');
    o.focus();
    t = false;
    return false;
  }
  o.classList.remove('fieldError');
  o.blur();
  s.innerHTML = '';
  return true;
}
function u(o) {
  const e = o.value.replace(/\D/g, '');
  if (/[^\d\s()-]/.test(o.value)) {
    let e = 'Telefone';
    a(o, e);
    o.classList.add('fieldError');
    o.focus();
    return false;
  }
  const t = e.substring(0, 2);
  const r = e.substring(2, e.length);
  let n;
  if (r.length === 9) {
    n = r.replace(/^(\d{5})(\d{4})/, '$1-$2');
  } else if (r.length === 8) {
    n = r.replace(/^(\d{4})(\d{4})/, '$1-$2');
  } else {
    s.innerHTML = '';
    s.innerHTML =
      'O campos "Telefone" precisa conter de 8 a 9 dígitos + o DDD.';
    o.classList.add('fieldError');
    o.focus();
    return false;
  }
  document.getElementById('phoneNumber').value = `(${t}) ${n}`;
  o.classList.remove('fieldError');
  o.blur();
  return true;
}
function c(e) {
  const o = document.querySelector('#homeNumber');
  var t = /^\d+$/;
  t.test(o.value);
  if (!t.test(o.value)) {
    s.innerHTML = 'cep falso';
    document.getElementById('postalCode').classList.add('fieldError');
    document.getElementById('postalCode').focus();
    return false;
  }
  document.getElementById('postalCode').classList.remove('fieldError');
  document.getElementById('postalCode').blur();
  s.innerHTML = '';
  return true;
}
function e(e) {
  const o = document.querySelector('.registre-form');
  const t = e.target;
  if (t.type === 'text' && t.name === 'name') {
    n(t);
  } else if (t.type === 'email' && t.name === 'email') {
    d(t);
  } else if (t.type === 'text' && t.name === 'rg') {
    i(t);
  } else if (t.type === 'text' && t.name === 'phoneNumber') {
    u(t);
  } else if (t.type === 'text' && t.name === 'postalCode') {
    l();
  } else if (t.type === 'text' && t.name === 'homeNumber') {
    c(t);
  }
}
function f(e) {
  const i = new XMLHttpRequest();
  const o = 'https://viacep.com.br/ws/' + e + '/json/';
  i.open('GET', o, true);
  i.onload = function () {
    if (i.readyState === i.DONE) {
      if (i.status === 200) {
        const e = JSON.parse(i.responseText);
        if (e.o) {
          s.innerHTML = 'O "CEP" digitado não existe!';
          document.getElementById('postalCode').classList.add('fieldError');
          document.getElementById('postalCode').focus();
        } else {
          const o = document.getElementById('street');
          const t = document.getElementById('neighborhood');
          const r = document.getElementById('city');
          const n = document.getElementById('state');
          o.value = e.t || '';
          t.value = e.i || '';
          r.value = e.u || '';
          n.value = e.l || '';
          o.disabled = true;
          t.disabled = true;
          r.disabled = true;
          n.disabled = true;
          s.innerHTML = '';
        }
      } else {
        s.innerHTML =
          'Ocorreu um erro. Por favor, busque pelo "CEP" novamente.';
      }
    }
  };
  i.send();
}
document.querySelector('.completeAddress').addEventListener('click', l);
function l() {
  let e = document.getElementById('postalCode').value;
  let o = document.querySelector('.erroMsg');
  if (e.length === 0) {
    o.innerHTML = '';
    o.innerHTML = 'O "CEP" não pode ficar vázio!';
    document.getElementById('postalCode').classList.add('fieldError');
    document.getElementById('postalCode').focus();
    return false;
  }
  if (e.length < 8 || e.length === '') {
    o.innerHTML = '';
    o.innerHTML = '"CEP" inválido!';
    document.getElementById('postalCode').classList.add('fieldError');
    document.getElementById('postalCode').focus();
    return false;
  }
  const t = e.replace(/[^\d]/g, '');
  const r = t.replace(/(\d{2})(\d{3})(\d{3})/, '$1.$2-$3');
  document.getElementById('postalCode').value = r;
  let n = t;
  f(n);
  document.getElementById('postalCode').classList.remove('fieldError');
  document.getElementById('postalCode').blur();
  return true;
}
function a(e, o) {
  if (e.value === '') {
    s.innerHTML = '';
    s.innerHTML = `O campo "${o}" não pode ficar vázio!`;
  } else {
    s.innerHTML = '';
    s.innerHTML = `O campo "${o}" é inválido!`;
  }
  e.classList.add('fieldError');
  e.focus();
  return;
}
const t = document.querySelector('.registre-form');
const o = t.querySelectorAll('input');
function r() {
  o.forEach((e) => {
    e.blur();
  });
}
document.addEventListener('clcik', function (e) {
  const o = e.target;
  if (!t.contains(o)) {
    r();
    console.log('Clicou!');
  }
});
